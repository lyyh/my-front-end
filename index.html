<!DOCTYPE html>
<html>

<head>
</head>
<style type="text/css">
    .box{
        border: 10px solid #333;
        position: absolute;
        top: 100px;
    }
</style>
<body>
    <div class="box"></div>
    <script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript">
    //绝对位置
    var relativeX = document.getElementsByClassName('box')[0].getBoundingClientRect().left;
    var relativeY = document.getElementsByClassName('box')[0].getBoundingClientRect().top;
    var absoluteX = relativeX + document.documentElement.scrollLeft;
    var absoluteY = relativeY + document.documentElement.scrollTop;

    function _LazyMan(name) {
        this.tasks = [];
        var self = this;
        var fn = (function(n) {
            var name = n;
            return function() {
                console.log('Hi! This is ' + name + '!');
                self.next();
            }
        })(name);
        this.tasks.push(fn);
        setTimeout(function() {
            self.next();
        }, 0);
    }

    _LazyMan.prototype.next = function() {
        var fn = this.tasks.shift();
        fn && fn();
    }
    _LazyMan.prototype.eat = function(name) {
        var self = this;
        var fn = (function(name) {
            return function() {
                console.log('Eat ' + name + '~');
                self.next();
            }
        })(name);
        this.tasks.push(fn);
        return this;
    }
    _LazyMan.prototype.sleep = function(time) {
        var self = this;
        var fn = (function(time) {
            return function() {
                setTimeout(function() {
                    console.log('Wake up after ' + time + 's!');
                    self.next();
                }, time * 1000);
            }
        })(time);
        this.tasks.push(fn);
        return this;
    }
    _LazyMan.prototype.sleepFirst = function(time) {
            var self = this;
            var fn = (function(time) {
                return function() {
                    setTimeout(function() {
                        console.log('Wake up after ' + time + 's!');
                        self.next();
                    }, time * 1000);
                }
            })(time);
            this.tasks.unshift(fn);
            return this;
        }
        //封装
    function LazyMan(name) {
        return new _LazyMan(name);
    }

    var lzym = LazyMan("Hank").eat("supper");
    lzym.eat("supper").eat("supper").eat("supper").eat("supper")
    </script>
</body>

</html>
