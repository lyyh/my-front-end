## 最近学习了一下jsonp，在此总结下
### 同源策略
同源策略（不同域的客户端脚本在没明确授权的情况下，不能读写对方的资源)会因为安全原因决绝请求，也就是我们不能向其它域直接发送请求以获取资源。  

### 什么是jsonp?
很简单，就是利用script标签没有跨域限制的“漏洞”（历史遗迹啊）来达到与第三方通讯的目的。当需要通讯时，本站脚本创建一个script元素，地址指向第三方的API网址，形如： 
<script src="http://www.example.net/api?param1=1&param2=2"></script>
 
并提供一个回调函数来接收数据（函数名可约定，或通过地址参数传递）。 
第三方产生的响应为json数据的包装（故称之为jsonp，即json padding），形如： 
callback({"name":"hax","gender":"Male"}) 
这样浏览器会调用callback函数，并传递解析后json对象作为参数。本站脚本可在callback函数里处理所传入的数据。 
补充：“历史遗迹”的意思就是，如果在今天重新设计的话，也许就不会允许这样简单的跨域了嘿，比如可能像XHR一样按照CORS规范要求服务器发送特定的http头。

JSONP是一种非正式传输协议，该协议的一个要点就是允许用户传递一个callback参数给服务端，然后服务端返回数据时会将这个callback参数作为函数名来包裹住JSON数据，这样客户端就可以随意定制自己的函数来自动处理返回数据了

jsonP本身就是一个get请求，而script节点本身也是一个get请求，这个思想是通过后端的配合（后端输出的 response text必须符合js语法）更好的利用了get请求而已。 

json 是一种数据格式
jsonp 是一种数据调用的方式。
jsonp 全称是JSON with Padding，是为了解决跨域请求资源而产生的解决方案。


JSONP的缺点则是：它只支持GET请求而不支持POST等其它类型的HTTP请求；json是一种数据格式，jsonp是非正式传输协议。jsonp里传输的就是json的数据格式，只是在发送请求时多加一个参数，其值为回调函数。后台程序在获得该回调函数后，把准备好的json数据拼接到回调函数里面。例子：
echo callback + '(' + json + ')';

以上内容参考自：
链接：https://www.zhihu.com/question/19966531/answer/22801250

### JSON与JSONP
首先先明确，JSON是一种轻量级的数据交换格式，JSONP是一种非正式的数据传输方式。
#### JSON的优点
1. 基于纯文本，跨平台传递极其简单；  
2. Javascript原生支持，后台语言几乎全部支持；  
3. 轻量级数据格式，占用字符数量极少，特别适合互联网传递；  
4. 可读性较强，虽然比不上XML那么一目了然，但在合理的依次缩进之后还是很容易识别的；  
5. 容易编写和解析，当然前提是你要知道数据结构；  

#### 什么是JSONP?
1. 一个众所周知的问题，Ajax直接请求普通文件存在跨域无权限访问的问题  
2. 不过我们又发现，Web页面上调用js文件时则不受是否跨域的影响（不仅如此，我们还发现凡是拥有"src"这个属性的标签都拥有跨域的能力，比如<script>、<img>、<iframe>）；script标签的属性src可以向不同域请求资源  
3. 于是可以判断，当前阶段如果想通过纯web端（ActiveX控件、服务端代理、属于未来的HTML5之Websocket等方式不算）跨域访问数据就只有一种可能，那就是在远程服务器上设法把数据装进js格式的文件里，供客户端调用和进一步处理；
4. 为了便于客户端使用数据，逐渐形成了一种非正式传输协议，人们把它称作JSONP，该协议的一个要点就是允许用户传递一个callback参数给服务端，然后服务端返回数据时会将这个callback参数作为函数名来包裹住JSON数据，这样客户端就可以随意定制自己的函数来自动处理返回数据了。

####jquery ajax对jsonp的封装
ajax 中jsonp和jsonpCallback参数为可填参数
服务器返回的json格式数据必须被回调函数名包装
####ajax和jsonp的区别
1. ajax的核心的通过xmlHttpRequest获取非本页面的内容，而jsonp的核心是动态添加<script>标签来调用服务器提供的js脚本
2. ajax和jsonp的区别不是在于是否跨域，ajax通过服务器代理也可以实现跨域，jsonp本质上也不排斥同源上数据的获取。
3. jsonp是一种方式或者说非强制性协议，如同ajax一样，它也不一定非要用json格式来传递数据，如果你愿意，字符串都行，只不过这样不利于用jsonp提供公开服务。
4. 总而言之，jsonp不是ajax的一个特例，哪怕jquery等巨头把jsonp封装进了ajax，也不能改变着一点！

可以参考：
[http://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html]

### jsonp的安全性问题
当然使用jsonp会在一定程度上造成安全性问题，如果请求的站点不是信任站点，那么可能会在返回的方法调用中包含一些恶意代码。所以尽量向信任的站点发送请求。另外xss也经常会利用jsonp向站点注入恶意代码。
